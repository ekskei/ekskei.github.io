import{_ as a,W as e,X as r,$ as i}from"./framework-b32ce0b5.js";const x={},h=i('<h1 id="静态库开发" tabindex="-1"><a class="header-anchor" href="#静态库开发" aria-hidden="true">#</a> 静态库开发</h1><h2 id="静态库与动态库的区别" tabindex="-1"><a class="header-anchor" href="#静态库与动态库的区别" aria-hidden="true">#</a> 静态库与动态库的区别</h2><p>静态库：在链接时，静态库的对象文件直接加入到目标文件中，生成可执行文件。运行时不需要加载静态库。</p><p>动态库：在链接时，只有动态库的引用加入到目标文件中，生成可执行文件。运行时需要加载动态库,然后调用动态库中的函数。</p><p>静态库文件扩展名为 .a ，动态库文件扩展名为 .so (Linux)或 .dll (Windows)。</p><p>静态库在编译和链接时 resolved，动态库在运行时 resolved。</p><p>静态库会增加程序的体积，而动态库可以被多个程序共享，减小体积。</p><p>动态库可以在不重新编译程序的情况下进行更新，而静态库的更新需要重新编译链接。</p><h2 id="静态库开发方法" tabindex="-1"><a class="header-anchor" href="#静态库开发方法" aria-hidden="true">#</a> 静态库开发方法</h2><ol><li><p>编写源文件。单独编译成目标文件(.o文件)。</p></li><li><p>使用ar命令打包多个目标文件成一个库文件。</p><p>ar rcs libxxx.a xxx1.o xxx2.o ...</p></li><li><p>ranlib工具为静态库建立索引，加速链接过程。</p><p>ranlib libxxx.a</p></li><li><p>在程序中用 -lxxx 标志链接静态库。</p></li><li><p>查看静态库包含哪些目标文件：ar -t libxxx.a</p></li></ol><h2 id="使用cmake构建静态库" tabindex="-1"><a class="header-anchor" href="#使用cmake构建静态库" aria-hidden="true">#</a> 使用CMake构建静态库</h2><h3 id="指定库的名称" tabindex="-1"><a class="header-anchor" href="#指定库的名称" aria-hidden="true">#</a> 指定库的名称</h3><p>add_library(xxx STATIC xxx1.c xxx2.c ...)</p><h3 id="生成静态库libxxx-a" tabindex="-1"><a class="header-anchor" href="#生成静态库libxxx-a" aria-hidden="true">#</a> 生成静态库libxxx.a</h3><p>set_target_properties(xxx PROPERTIES OUTPUT_NAME &quot;xxx&quot;)</p><h3 id="手动指定库文件名" tabindex="-1"><a class="header-anchor" href="#手动指定库文件名" aria-hidden="true">#</a> 手动指定库文件名</h3><p>set_target_properties(xxx PROPERTIES PREFIX &quot;lib&quot; SUFFIX &quot;.a&quot; OUTPUT_NAME &quot;xxx&quot;)</p><h3 id="去掉库文件名前缀" tabindex="-1"><a class="header-anchor" href="#去掉库文件名前缀" aria-hidden="true">#</a> 去掉库文件名前缀</h3><p>set_target_properties(xxx PROPERTIES PREFIX &quot;&quot;)</p><h3 id="把静态库放进动态库" tabindex="-1"><a class="header-anchor" href="#把静态库放进动态库" aria-hidden="true">#</a> 把静态库放进动态库</h3><p>target_link_libraries(xxx -Wl,--whole-archive libmmm.a libnnn.a -Wl,--no-whole-archive)</p>',21),t=[h];function d(l,n){return e(),r("div",null,t)}const p=a(x,[["render",d],["__file","静态库开发.html.vue"]]);export{p as default};
